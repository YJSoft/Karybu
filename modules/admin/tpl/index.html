<include target="./_spHeader.html" />
    <div class="row-fluid page-header">
        <div class="span12">
            <div class="">
                <i class="big-icon big-icon-dashboard pull-left"></i>
                <h1>Dashboard</h1>
            </div>
        </div>
    </div>
    <div cond="$XE_VALIDATOR_MESSAGE" class="message {$XE_VALIDATOR_MESSAGE_TYPE}">
        <p>{$XE_VALIDATOR_MESSAGE}</p>
    </div>
    <div class="row-fluid swatchBoard">
        <div class="span2 turquoise swatch">
            <div class="corner"></div>
            <h1>{number_format($status->total_visitor)}(<!--@if($status->visitor > 0)-->+<!--@end-->{number_format($status->visitor)})</h1>
            <a href="{getUrl('', 'module', 'admin', 'act', 'dispCounterAdminIndex')}">{$lang->visitors}</a>
        </div>
        <div class="span2 red swatch">
            <div class="corner"></div>
            <h1>{number_format($status->member->totalCount)}(<!--@if($status->member->todayCount > 0)-->+<!--@end-->{number_format($status->member->todayCount)})</h1>
            <a href="{getUrl('', 'module', 'admin', 'act', 'dispMemberAdminList')}">{$lang->menu_gnb['user']}</a>
        </div>
        <div class="span2 yellow swatch">
            <div class="corner"></div>
            <h1>{number_format($status->document->totalCount)}(<!--@if($status->document->todayCount > 0)-->+<!--@end-->{number_format($status->document->todayCount)})</h1>
            <a href="{getUrl('', 'module', 'admin', 'act', 'dispDocumentAdminList')}">{$lang->menu_gnb_sub['document']}</a>
        </div>
        <div class="span2 blue swatch">
            <div class="corner"></div>
            <h1>{number_format($status->comment->totalCount)}(<!--@if($status->comment->todayCount > 0)-->+<!--@end-->{$status->comment->todayCount})</h1>
            <a href="{getUrl('', 'module', 'admin', 'act', 'dispCommentAdminList')}">{$lang->menu_gnb_sub['comment']}</a>
        </div>
        <div class="span2 purple swatch">
            <div class="corner"></div>
            <h1>{number_format($status->trackback->totalCount)}(<!--@if($status->trackback->todayCount > 0)-->+<!--@end-->{$status->trackback->todayCount})</h1>
            <a href="{getUrl('', 'module', 'admin', 'act', 'dispTrackbackAdminList')}">{$lang->menu_gnb_sub['trackback']}</a>
        </div>
        <div class="span2 green swatch">
            <div class="corner"></div>
            <h1>{number_format($status->file->totalCount)}(<!--@if($status->file->todayCount > 0)-->+<!--@end-->{number_format($status->file->todayCount)})</h1>
            <a href="{getUrl('', 'module', 'admin', 'act', 'dispFileAdminList')}">{$lang->menu_gnb_sub['file']}</a>
        </div>
    </div>
        <!--@if(!$isEnviromentGatheringAgreement)-->
        <form action="./" method="post" class="message info alert alert-info">
        <input type="hidden" name="module" value="admin" />
        <input type="hidden" name="act" value="procAdminEnviromentGatheringAgreement" />
            <h2>{$lang->install_env_agreement}</h2>
            <p>{$lang->install_env_agreement_desc}</p>
            <div class="btnArea">
                <button  class="btn" type="submit" name="is_agree" value="false">{$lang->disagree}</button>
                <button  class="btn btn-success" type="submit" name="is_agree" value="true">{$lang->agree}</button>
            </div>
        </form>
        <!--@end-->
        <!--@if($addTables || $needUpdate)-->
        <div class="message update">
            <h2 cond="$needUpdate && $addTables">{$lang->need_update_and_table}</h2>
            <h2 cond="$needUpdate && !$addTables">{$lang->need_update}</h2>
            <h2 cond="!$needUpdate && $addTables">{$lang->need_table}</h2>
            <ul>
            <!--@foreach($module_list AS $key => $value)-->
                <!--@if($value->need_install)-->
                <li style="margin:0 0 4px 0;">{$value->module} - <span class="btn"><button type="button" onclick="doInstallModule('{$value->module}')">{$lang->cmd_create_db_table}</button></span></li>
                <!--@else if($value->need_update)-->
                <li style="margin:0 0 4px 0;">{$value->module} - <span class="btn"><button type="button" onclick="doUpdateModule('{$value->module}')">{$lang->cmd_module_update}</button></span></li>
                <!--@end-->
            <!--@end-->
            </ul>
        </div>
        <!--@end-->
        <div class="row-fluid">
            <div class="span12 pull-right section">
                <div class="row-fluid">
                    <div class="portlet box span4">
                        <div class="box-header"><h3 class="h3"><a href="{getUrl('', 'module', 'admin', 'act', 'dispDocumentAdminList')}">{$lang->latest_documents}</a></h3></div>
                        <div class="box-body">
                            <ul class="unstyled lined">
                            <!--@foreach($latestDocumentList AS $key=>$value)-->
                            {@$document = $value->variables}
                            <li>
                                <a href="{getUrl('', 'document_srl', $document['document_srl'])}" target="_blank"><!--@if(trim($value->getTitle()))-->{$value->getTitle()}<!--@else--><strong>{$lang->no_title_document}</strong><!--@end--></a> <span class="side">{$document['nick_name']}</span>
                                <form class="action">
                                    <input type="hidden" name="module" value="admin" />
                                    <input type="hidden" name="act" value="procDocumentManageCheckedDocument" />
                                    <input type="hidden" name="cart[]" value="{$document['document_srl']}" />
                                    <input type="hidden" name="success_return_url" value="{getUrl('', 'module', 'admin')}" />
                                    <button type="submit" name="type" value="trash" class="text">{$lang->cmd_trash}</button>
                                    <button type="submit" name="type" value="delete" class="text">{$lang->cmd_delete}</button>
                                </form>
                            </li>
                            <!--@end-->
                            <li cond="!is_array($latestDocumentList) || count($latestDocumentList) < 1">{$lang->no_data}</li>
                        </ul>
                        </div>
                    </div>
                    <div class="portlet box span4">
                        <div class="box-header"><h3 class="h3"><a href="{getUrl('', 'module', 'admin', 'act', 'dispTrackbackAdminList')}">{$lang->latest_trackbacks}</a></h3></div>
                        <div class="box-body visitor">
                            <!-- Visotors Graph -->
                            <canvas class="visitor-chart" id="chart"></canvas>
                            <!-- /Visotors Graph -->
                        </div>
                    </div>

                </div>
            </div>
            <include target="./_spShortcut.html" />
        </div>
<include target="./_spFooter.html" />
<script>
    CreateCharts = function ()
    {

        var chart = new RGraph.Line('chart', [
            <!--@ $max=0;--><!--@end-->
            <!--@foreach($status->week as $key => $val)-->
                {number_format($val->this)},
                <!--@if($val->this > $max)-->
                    <!--@ $max = $val->this;--><!--@end-->
                <!--@end-->
            <!--@end-->]);
        chart.Set('chart.colors', ['white']);
        chart.Set('chart.linewidth', 3);
        chart.Set('chart.spline', true);
        chart.Set('chart.background.color', 'rgba(104, 210, 198, 1)');
        chart.Set('chart.filled', true);
        chart.Set('chart.fillstyle', 'rgba(87, 197, 188, 1)');
        chart.Set('chart.background.grid', false);
        chart.Set('chart.ylabels', false);
        chart.Set('chart.gutter.left', 0);
        chart.Set('chart.gutter.right', 0);
        chart.Set('chart.gutter.top', 0);
        chart.Set('chart.gutter.bottom', 0);
        chart.Set('chart.labels', false);
        chart.Set('chart.noaxes', true);
        chart.Set('chart.hmargin', 1);
        chart.Set('chart.ymax', {$max*1.2});
        chart.Set('chart.animation.unfold.initial', 0);
        chart.Set('chart.tooltips', [
            <!--@foreach($status->week as $key => $val)-->
            '{$key}: <b>{number_format($val->this)}</b> vistors',
            <!--@end-->]);
        chart.Draw();
    }

    if(!RGraph.isOld()) {
        CreateCharts();
    }else {
        window.onload = CreateCharts;
    }
</script>
